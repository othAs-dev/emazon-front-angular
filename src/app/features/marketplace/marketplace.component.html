<section class="overflow-hidden min-h-screen">
    <mat-toolbar class="w-full flex justify-between top-0" color="primary">
        <div class="flex items-center">
            <button (click)="isExpanded = !isExpanded" class="hover:bg-[#f6a636]" mat-icon-button>
                <mat-icon>menu</mat-icon>
            </button>
            <a routerLink="./home">
                <img class="w-16" src="assets/icons/ez.png" alt="logo">
            </a>
        </div>
        <div class="flex flex-row gap-3">
            <button
                mat-button
                mat-flat-button
                color="primary"
                routerLink="./cart"
                [matBadge]="productsAddedToCart$ | async"
                matBadgeColor="warn"
            >
                <mat-icon class="text-white" iconPositionEnd>shopping_cart</mat-icon>
                Panier
            </button>
            <button
                mat-button
                mat-flat-button
                color="primary"
                [matMenuTriggerFor]="menu"
                [matTooltip]="(isLoggedIn | async) ? 'Mon compte' : 'Se connecter'"
                [routerLink]="!(isLoggedIn | async) ? '../auth/login': null"

            >
                <mat-icon class="text-white" iconPositionEnd>person</mat-icon>
                {{ nameOrConnect | async}}
            </button>
            <mat-menu #menu="matMenu" overlapTrigger="false">
                <button mat-menu-item *ngIf="isLoggedIn" routerLink="../account/login">Mon Compte</button>
                <button mat-menu-item *ngIf="isLoggedIn" (click)="logout()">Déconnexion</button>
            </mat-menu>
        </div>
    </mat-toolbar>
    <mat-sidenav-container class="min-h-screen fixed">
        <mat-sidenav mode="side" opened="true" [ngClass]="{'hidden-important': !isExpanded, 'visible': isExpanded}"
                     class="tablet:block">
            <mat-nav-list>
                <mat-list-item routerLink="./home">
                    <span *ngIf="isExpanded" class="full-width">Accueil</span>
                    <mat-icon *ngIf="!isExpanded" class="hover:text-[#f6a636]">home</mat-icon>
                </mat-list-item>
                <mat-list-item (click)="isExpanded = true">
                    <form *ngIf="isExpanded" (ngSubmit)="submit()" class="h-12" [formGroup]="form">
                        <formly-form [fields]="fields" [form]="form" [model]="model" [options]="options"></formly-form>
                    </form>
                    <mat-icon *ngIf="!isExpanded" class="hover:text-[#f6a636]">search</mat-icon>
                </mat-list-item>
                <mat-list-item (click)="showSmartphonesMenu = !showSmartphonesMenu">
                    <span *ngIf="isExpanded" class="full-width">Smartphones</span>
                    <mat-icon (click)="isExpanded = true" *ngIf="!isExpanded" class="hover:text-[#f6a636]">
                        phone_iphone
                    </mat-icon>
                    <mat-icon *ngIf="isExpanded" [ngClass]="{'rotated' : showSmartphonesMenu}"
                              class="menu-button pt-1.5">
                        expand_more
                    </mat-icon>
                </mat-list-item>
                <div *ngIf="isExpanded" [ngClass]="{'expanded' : showSmartphonesMenu}" class="submenu">
                    <a routerLink="./category/smartphones" mat-list-item>Voir tout</a>
                    <a routerLink="./category/iphones" mat-list-item>iPhone</a>
                    <a routerLink="./category/google-pixel" mat-list-item>Google Pixel</a>
                    <a routerLink="./category/samsung" mat-list-item>Samsung</a>
                    <a routerLink="./category/xiaomi" mat-list-item>Xiaomi</a>
                </div>
                <mat-list-item (click)="showComputersMenu = !showComputersMenu">
                    <span *ngIf="isExpanded" class="full-width">Ordinateurs</span>
                    <mat-icon (click)="isExpanded = true" *ngIf="!isExpanded" class="hover:text-[#f6a636]">laptop
                    </mat-icon>
                    <mat-icon *ngIf="isExpanded" [ngClass]="{'rotated' : showComputersMenu}"
                              class="menu-button pt-1.5">
                        expand_more
                    </mat-icon>
                </mat-list-item>
                <div *ngIf="isExpanded" [ngClass]="{'expanded' : showComputersMenu}" class="submenu">
                    <a routerLink="./category/computers" mat-list-item>Voir tout</a>
                    <mat-list-item (click)="showDesktopSubMenu = !showDesktopSubMenu">
                        <span *ngIf="isExpanded" class="full-width">Bureau</span>
                        <mat-icon *ngIf="isExpanded" [ngClass]="{'rotated' : showDesktopSubMenu}" class="menu-button">
                            expand_more
                        </mat-icon>
                    </mat-list-item>
                    <div *ngIf="isExpanded" [ngClass]="{'expanded' : showDesktopSubMenu}" class="submenu">
                        <mat-list-item routerLink="./category/desktops">Voir tout</mat-list-item>
                        <mat-list-item routerLink="./category/imac">iMac</mat-list-item>
                        <mat-list-item routerLink="./category/computers">Unité centrale</mat-list-item>
                    </div>
                    <mat-list-item (click)="showLaptopSubMenu = !showLaptopSubMenu">
                        <span *ngIf="isExpanded" class="full-width">Portable</span>
                        <mat-icon *ngIf="isExpanded" [ngClass]="{'rotated' : showLaptopSubMenu}" class="menu-button">
                            expand_more
                        </mat-icon>
                    </mat-list-item>
                    <div *ngIf="isExpanded" [ngClass]="{'expanded' : showLaptopSubMenu}" class="submenu">
                        <mat-list-item routerLink="./category/laptops">Voir tout</mat-list-item>
                        <mat-list-item routerLink="./category/macbook">Macbook</mat-list-item>
                        <mat-list-item routerLink="./category/microsoft-surface">Microsoft Surface</mat-list-item>
                        <mat-list-item routerLink="./category/chromebook">Chromebook</mat-list-item>
                    </div>
                </div>
                <mat-list-item (click)="showTabletsMenu = !showTabletsMenu">
                    <span *ngIf="isExpanded" class="full-width hover:text-[#f6a636]">Tablettes</span>
                    <mat-icon (click)="isExpanded = true" *ngIf="!isExpanded" class="hover:text-[#f6a636]">tablet_mac
                    </mat-icon>
                    <mat-icon *ngIf="isExpanded" [ngClass]="{'rotated' : showTabletsMenu}" class="menu-button pt-1.5">
                        expand_more
                    </mat-icon>
                </mat-list-item>
                <div *ngIf="isExpanded" [ngClass]="{'expanded' : showTabletsMenu}" class="submenu">
                    <a routerLink="./category/tablets" mat-list-item>Voir tout</a>
                    <a routerLink="./category/ipad" mat-list-item>iPad</a>
                    <a routerLink="./category/samsung-tabs" mat-list-item>Samsung Galaxy</a>
                    <a routerLink="./category/lenovo-tabs" mat-list-item>Lenovo Tab</a>
                </div>
                <mat-list-item (click)="showAudioAndSoundMenu = !showAudioAndSoundMenu">
                    <span *ngIf="isExpanded" class="full-width">Audio & Son</span>
                    <mat-icon (click)="isExpanded = true" *ngIf="!isExpanded" class="hover:text-[#f6a636]">headset
                    </mat-icon>
                    <mat-icon *ngIf="isExpanded" [ngClass]="{'rotated' : showAudioAndSoundMenu}"
                              class="menu-button pt-1.5">
                        expand_more
                    </mat-icon>
                </mat-list-item>
                <div *ngIf="isExpanded" [ngClass]="{'expanded' : showAudioAndSoundMenu}" class="submenu">
                    <a routerLink="./category/audio-and-sound" mat-list-item>Voir tout</a>
                    <mat-list-item (click)="showSpeakersSubMenu = !showSpeakersSubMenu">
                        <span *ngIf="isExpanded" class="full-width hover:text-[#f6a636]">Enceintes</span>
                        <mat-icon *ngIf="isExpanded" [ngClass]="{'rotated' : showSpeakersSubMenu}" class="menu-button">
                            expand_more
                        </mat-icon>
                    </mat-list-item>
                    <div *ngIf="isExpanded" [ngClass]="{'expanded' : showSpeakersSubMenu}" class="submenu">
                        <mat-list-item routerLink="./category/speakers">Voir tout</mat-list-item>
                        <mat-list-item routerLink="./category/homepod">HomePod</mat-list-item>
                        <mat-list-item routerLink="./category/google-home">Google Home</mat-list-item>
                        <mat-list-item routerLink="./category/amazon-alexa">Amazon Alexa</mat-list-item>
                    </div>
                    <mat-list-item (click)="showHeadphonesSubMenu = !showHeadphonesSubMenu">
                        <span *ngIf="isExpanded" class="full-width">Casques</span>
                        <mat-icon *ngIf="isExpanded" [ngClass]="{'rotated' : showHeadphonesSubMenu}"
                                  class="menu-button">
                            expand_more
                        </mat-icon>
                    </mat-list-item>
                    <div *ngIf="isExpanded" [ngClass]="{'expanded' : showHeadphonesSubMenu}" class="submenu">
                        <mat-list-item routerLink="./category/headphones">Voir tout</mat-list-item>
                        <mat-list-item routerLink="./category/airpods">Airpods</mat-list-item>
                        <mat-list-item routerLink="./category/galaxy-buds">Galaxy Buds</mat-list-item>
                        <mat-list-item routerLink="./category/dyson">Dyson</mat-list-item>
                    </div>
                </div>
                <mat-list-item routerLink="./shops">
                    <span *ngIf="isExpanded" class="full-width">Magasins</span>
                    <mat-icon *ngIf="!isExpanded" class="hover:text-[#f6a636]">place</mat-icon>
                </mat-list-item>
            </mat-nav-list>
        </mat-sidenav>
        <mat-sidenav-content>
            <section (click)="isExpanded = false" class="scroll-auto h-full">
                <router-outlet />
            </section>
        </mat-sidenav-content>
    </mat-sidenav-container>
</section>
